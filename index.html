<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Angle Arena ‚Äî Fun Geometry Game</title>
  <style>
    :root{--ink:#f8fafc;--muted:#94a3b8;--accent:#38bdf8}
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Segoe UI,Arial,sans-serif;color:var(--ink);min-height:100vh;display:flex;flex-direction:column;align-items:center;overflow-x:hidden;
      background:
        radial-gradient(1200px 600px at 10% -100px,#1e3a8a 10%,#0f172a 60%),
        radial-gradient(1000px 500px at 90% -120px,#0ea5e9 5%,transparent 50%),
        linear-gradient(180deg,#0f172a,#0b1324 60%,#0a1020);
    }
    /* Animated background bits */
    .bg-layer{position:fixed; inset:0; pointer-events:none; z-index:-1}
    .stars{position:absolute; inset:0; overflow:hidden}
    .star{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;opacity:.8;animation: twinkle 3s ease-in-out infinite}
    @keyframes twinkle{0%,100%{opacity:.2}50%{opacity:1}}
    .orbs{position:absolute; inset:0; overflow:hidden}
    .orb{position:absolute; width:220px; height:220px; border-radius:50%; filter:blur(40px); opacity:.15; animation: float 12s ease-in-out infinite}
    .orb.blue{background:#38bdf8}
    .orb.purple{background:#a78bfa}
    .orb.green{background:#22c55e}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-30px)}}

    header{padding:20px;text-align:center}
    h1{margin:0;font-size:32px;color:var(--accent);text-shadow:2px 2px #0f172a}
    .game{background:rgba(255,255,255,0.08);border:2px solid #334155;border-radius:16px;padding:20px;max-width:860px;width:92%;box-shadow:0 10px 40px rgba(0,0,0,0.6)}
    .hud{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-bottom:14px}
    .badge{background:#0a1328;border:1px solid #1e293b;border-radius:999px;padding:6px 12px;font-weight:bold}
    #prompt{font-size:20px;font-weight:800;margin:10px 0;color:#facc15;text-align:center}
    .diagram{background:#0a1226;border:1px solid #1e293b;border-radius:12px;height:320px;display:grid;place-items:center;margin:12px 0;position:relative}
    svg{width:100%;height:100%}
    input,button{padding:8px 12px;border-radius:8px;border:1px solid #334155;background:#1e293b;color:var(--ink);font-size:15px}
    button{cursor:pointer;transition:.2s}
    button:hover{background:#334155;transform:translateY(-1px)}
    .steps{background:#0b1224;border:1px dashed #475569;border-radius:8px;padding:10px;margin-top:10px}
    .feedback{margin-top:6px;font-weight:bold;text-align:center}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:center}
    .hidden{display:none}
    .error-badge{display:none;color:#fecaca;background:#450a0a;border:1px solid #7f1d1d;border-radius:999px;padding:6px 10px;font-weight:700}
  </style>
</head>
<body>
  <!-- playful animated background -->
  <div class="bg-layer">
    <div class="orbs" id="orbs"></div>
    <div class="stars" id="stars"></div>
  </div>

  <header>
    <h1>üéâ Angle Arena ‚Äî Solve for x!</h1>
  </header>
  <div class="game">
    <div class="hud">
      <div class="badge">‚è±Ô∏è Time: <span id="time">‚Äî</span></div>
      <div class="badge">üèÜ Score: <span id="score">0</span></div>
      <div class="badge">üî• Streak: <span id="streak">0</span></div>
    </div>
    <div id="prompt">Press Start to Begin</div>
    <div class="diagram">
      <svg id="svg" viewBox="0 0 520 320" aria-label="Angle diagram with labeled points"></svg>
    </div>
    <div class="row">
      <label>Answer for <b>x</b>:</label>
      <input id="answer" type="text" inputmode="decimal" placeholder="e.g. 12 or 25/2"/>
      <button id="checkBtn" disabled>Check</button>
      <button id="nextBtn" class="hidden">Next ‚ñ∂</button>
    </div>
    <div id="feedback" class="feedback"></div>
    <div id="steps" class="steps" hidden></div>
    <div class="row" style="margin-top:10px">
      <button id="startBtn">Start</button>
      <span id="errBadge" class="error-badge">Script error ‚Äî open console</span>
    </div>
  </div>

  <script>
    // Show errors on page if any script fails
    window.addEventListener('error', ()=>{ document.getElementById('errBadge').style.display='inline-block'; });

    // Elements
    const svg = document.getElementById('svg');
    const promptEl = document.getElementById('prompt'); // avoid clashing with window.prompt
    const feedback = document.getElementById('feedback');
    const stepsBox = document.getElementById('steps');
    const ansInput = document.getElementById('answer');
    const checkBtn = document.getElementById('checkBtn');
    const nextBtn = document.getElementById('nextBtn');
    const startBtn = document.getElementById('startBtn');
    const scoreEl = document.getElementById('score');
    const streakEl = document.getElementById('streak');
    const timeEl = document.getElementById('time');

    let current=null, score=0, streak=0, timer=null, time=0, running=false, seq=0;

    // SVG helpers
    function NS(tag){ return document.createElementNS('http://www.w3.org/2000/svg', tag); }
    function rect(x,y,w,h,fill){ const el=NS('rect'); el.setAttribute('x',x); el.setAttribute('y',y); el.setAttribute('width',w); el.setAttribute('height',h); el.setAttribute('fill',fill); return el; }
    function line(x1,y1,x2,y2){ const el=NS('line'); el.setAttribute('x1',x1); el.setAttribute('y1',y1); el.setAttribute('x2',x2); el.setAttribute('y2',y2); el.setAttribute('stroke','#f8fafc'); el.setAttribute('stroke-width',3); return el; }
    function circle(x,y,r,fill='#38bdf8'){ const el=NS('circle'); el.setAttribute('cx',x); el.setAttribute('cy',y); el.setAttribute('r',r); el.setAttribute('fill',fill); return el; }
    function textEl(x,y,t,fill='#facc15'){ const el=NS('text'); el.setAttribute('x',x); el.setAttribute('y',y); el.setAttribute('fill',fill); el.setAttribute('font-size','16'); el.setAttribute('font-weight','700'); el.textContent=t; return el; }
    function polar(cx,cy,r,a){ const rad=a*Math.PI/180; return {x: cx + r*Math.cos(rad), y: cy - r*Math.sin(rad)}; }
    function arc(cx,cy,r,a1,a2,color='#38bdf8',w=3){
      const p=NS('path'); const P1=polar(cx,cy,r,a1), P2=polar(cx,cy,r,a2); const laf=(a2-a1)<=180?0:1;
      const d=`M ${P1.x} ${P1.y} A ${r} ${r} 0 ${laf} 1 ${P2.x} ${P2.y}`;
      p.setAttribute('d',d); p.setAttribute('stroke',color); p.setAttribute('fill','none'); p.setAttribute('stroke-width',w); return p;
    }
    function drawBase(){ svg.innerHTML=''; svg.appendChild(rect(0,0,520,320,'#0a1226')); }

    // Conventions
    const BX=260, BY=220; // vertex B

    // Problems (start with rock-solid Right Angle only)
    function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

    function genRightAngle(){
      const a=randInt(1,4), b=randInt(-10,20); const x=(90-b)/a; const id=++seq;
      const prompt=`m‚à†ABC = ${a}x ${b>=0?'+':''}${b}¬∞. Solve for x if ‚à†ABC is a right angle.`;
      const steps=`Right angle = 90¬∞ ‚Üí ${a}x ${b>=0?'+':''}${b} = 90 ‚Üí x = ${x}`;
      function diagram(){ drawBase();
        const A=polar(BX,BY,150,0), C=polar(BX,BY,150,90);
        svg.appendChild(line(BX,BY,A.x,A.y)); svg.appendChild(line(BX,BY,C.x,C.y));
        svg.appendChild(arc(BX,BY,40,0,90));
        // right-angle marker square
        const p1=polar(BX,BY,22,0), p2=polar(BX,BY,22,90);
        const q=NS('path'); q.setAttribute('d',`M ${BX} ${BY} L ${p1.x} ${p1.y} L ${p1.x+p2.x-BX} ${p1.y+p2.y-BY} L ${p2.x} ${p2.y} Z`);
        q.setAttribute('fill','#22d3ee'); q.setAttribute('opacity','0.35'); q.setAttribute('stroke','#38bdf8'); q.setAttribute('stroke-width','2'); svg.appendChild(q);
        svg.appendChild(circle(BX,BY,4));
        svg.appendChild(textEl(A.x+6,A.y+18,'A','#c7d2fe'));
        svg.appendChild(textEl(BX-16,BY+18,'B','#c7d2fe'));
        svg.appendChild(textEl(C.x-14,C.y-8,'C','#c7d2fe'));
        svg.appendChild(textEl(BX+46,BY-8,`${a}x ${b>=0?'+':''}${b}¬∞`,'#93c5fd'));
      }
      return {id,prompt,steps,x,diagram};
    }

    // Parse number: accepts decimals or fractions like 25/2
    function parseNum(s){
      if(/^[-+]?\d+(?:\.\d+)?$/.test(s)) return Number(s);
      const m = s.match(/^\s*([-+]?\d+(?:\.\d+)?)\s*\/\s*([-+]?\d+(?:\.\d+)?)\s*$/);
      if(m){ const n = Number(m[1]); const d = Number(m[2]); if(d!==0) return n/d; }
      return null;
    }

    // Game flow
    function startGame(){
      score=0; streak=0; time=240; // 4 minutes
      scoreEl.textContent=0; streakEl.textContent=0; timeEl.textContent=time; feedback.textContent='';
      checkBtn.disabled=false; nextBtn.classList.add('hidden'); stepsBox.hidden=true; running=true;
      nextProblem();
      clearInterval(timer);
      timer=setInterval(()=>{
        time--; timeEl.textContent=time;
        if(time<=0){ clearInterval(timer); running=false; promptEl.textContent='‚è∞ Time up!'; checkBtn.disabled=true; }
      },1000);
    }

    function nextProblem(){
      if(!running) return;
      const p = genRightAngle();
      current = p;
      promptEl.innerHTML = p.prompt;
      p.diagram();
      ansInput.value='';
      stepsBox.hidden=true; feedback.textContent=''; nextBtn.classList.add('hidden');
    }

    function checkAnswer(){
      if(!running||!current) return;
      const v = parseNum(ansInput.value.trim());
      if(v===null){ feedback.textContent='Enter a valid number (e.g., 12 or 25/2).'; return; }
      const ok = Math.abs(v - current.x) < 1e-9;
      if(ok){
        score += 100; streak++;
        scoreEl.textContent = score; streakEl.textContent = streak;
        feedback.textContent = '‚úÖ Correct!';
        stepsBox.hidden = false; stepsBox.innerHTML = current.steps;
        nextBtn.classList.remove('hidden');
      } else {
        streak = 0; streakEl.textContent = streak; feedback.textContent = '‚ùå Try again.';
      }
    }

    // Events
    checkBtn.addEventListener('click', checkAnswer);
    nextBtn.addEventListener('click', nextProblem);
    ansInput.addEventListener('keydown', e=>{ if(e.key==='Enter') checkAnswer(); });
    startBtn.addEventListener('click', startGame);

    // Background particles (after DOM is ready)
    document.addEventListener('DOMContentLoaded', ()=>{
      const stars=document.getElementById('stars');
      for(let i=0;i<100;i++){
        const s=document.createElement('div');
        s.className='star';
        s.style.left=Math.random()*100+'%';
        s.style.top=Math.random()*100+'%';
        s.style.animationDuration=(2+Math.random()*3)+'s';
        stars.appendChild(s);
      }
      const orbs=document.getElementById('orbs');
      const make=(cls,l,t)=>{ const d=document.createElement('div'); d.className='orb '+cls; d.style.left=l; d.style.top=t; d.style.animationDelay=(-Math.random()*6)+'s'; orbs.appendChild(d); };
      make('blue','5%','70%'); make('purple','80%','60%'); make('green','60%','5%');
    });
  </script>
</body>
</html>

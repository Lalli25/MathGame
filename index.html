<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Angle Arena ‚Äî Fun Geometry Game</title>
  <style>
    body{
      margin:0;
      font-family:Segoe UI,Arial,sans-serif;
      background:radial-gradient(circle at top left, #1e40af, #0f172a 70%);
      color:#f8fafc;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      overflow-x:hidden;
    }
    header{padding:20px;text-align:center}
    h1{margin:0;font-size:32px;color:#38bdf8;text-shadow:2px 2px #0f172a}
    .game{background:rgba(255,255,255,0.08);border:2px solid #334155;border-radius:16px;padding:20px;max-width:850px;width:90%;box-shadow:0 10px 40px rgba(0,0,0,0.6)}
    .hud{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-bottom:14px}
    .badge{background:#0a1328;border:1px solid #1e293b;border-radius:999px;padding:6px 12px;font-weight:bold}
    #prompt{font-size:20px;font-weight:bold;margin:10px 0;color:#facc15;text-align:center}
    .diagram{background:#0a1226;border:1px solid #1e293b;border-radius:12px;height:300px;display:grid;place-items:center;margin:12px 0;position:relative;overflow:hidden}
    svg{width:100%;height:100%}
    input,button{padding:8px 12px;border-radius:8px;border:1px solid #334155;background:#1e293b;color:#f8fafc;font-size:15px}
    button{cursor:pointer;transition:0.2s}
    button:hover{background:#334155;transform:scale(1.05)}
    .steps{background:#1e293b;border:1px dashed #475569;border-radius:8px;padding:8px;margin-top:10px}
    .feedback{margin-top:6px;font-weight:bold;text-align:center}

    /* Fun animated background */
    .stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;overflow:hidden}
    .star{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;opacity:0.8;animation:twinkle 3s infinite ease-in-out}
    @keyframes twinkle{0%,100%{opacity:0.2}50%{opacity:1}}
  </style>
</head>
<body>
  <div class="stars" id="stars"></div>
  <header>
    <h1>üéâ Angle Arena ‚Äî Solve for x!</h1>
  </header>
  <div class="game">
    <div class="hud">
      <div class="badge">‚è±Ô∏è Time: <span id="time">‚Äî</span></div>
      <div class="badge">üèÜ Score: <span id="score">0</span></div>
      <div class="badge">üî• Streak: <span id="streak">0</span></div>
    </div>
    <div id="prompt">Press Start to Begin</div>
    <div class="diagram">
      <svg id="svg" viewBox="0 0 500 300" aria-label="Angle diagram with labeled points"></svg>
    </div>
    <div style="text-align:center">
      <label>Answer for <b>x</b>:</label>
      <input id="answer" type="text" inputmode="decimal" placeholder="e.g. 12 or 25/2"/>
      <button id="checkBtn">Check</button>
      <span id="feedback" class="feedback"></span>
    </div>
    <div style="text-align:center;margin-top:10px">
      <button id="startBtn">Start</button>
    </div>
    <div id="steps" class="steps" hidden></div>
  </div>

  <script>
    const svg = document.getElementById('svg');
    const prompt = document.getElementById('prompt');
    const feedback = document.getElementById('feedback');
    const stepsBox = document.getElementById('steps');
    const ansInput = document.getElementById('answer');
    const checkBtn = document.getElementById('checkBtn');
    const startBtn = document.getElementById('startBtn');
    const scoreEl = document.getElementById('score');
    const streakEl = document.getElementById('streak');
    const timeEl = document.getElementById('time');

    let current=null, score=0, streak=0, timer=null, time=0, running=false;

    function randInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}
    function drawBase(){svg.innerHTML=''; svg.appendChild(rect(0,0,500,300,'#0a1226'))}
    function rect(x,y,w,h,fill){const el=document.createElementNS('http://www.w3.org/2000/svg','rect'); el.setAttribute('x',x); el.setAttribute('y',y); el.setAttribute('width',w); el.setAttribute('height',h); el.setAttribute('fill',fill); return el;}
    function circle(x,y,r){const el=document.createElementNS('http://www.w3.org/2000/svg','circle'); el.setAttribute('cx',x); el.setAttribute('cy',y); el.setAttribute('r',r); el.setAttribute('fill','#38bdf8'); return el;}
    function line(x1,y1,x2,y2){const el=document.createElementNS('http://www.w3.org/2000/svg','line'); el.setAttribute('x1',x1); el.setAttribute('y1',y1); el.setAttribute('x2',x2); el.setAttribute('y2',y2); el.setAttribute('stroke','#f8fafc'); el.setAttribute('stroke-width',3); return el;}
    function textEl(x,y,t){const el=document.createElementNS('http://www.w3.org/2000/svg','text'); el.setAttribute('x',x); el.setAttribute('y',y); el.setAttribute('fill','#facc15'); el.setAttribute('font-size','16'); el.setAttribute('font-weight','700'); el.textContent=t; return el;}

    function genRightAngle(){
      const a=randInt(1,4), b=randInt(-10,20); const sol=(90-b)/a;
      const promptText=`m‚à†ABC = ${a}x ${b>=0?'+':''}${b}¬∞. Solve for x if ‚à†ABC is a right angle.`;
      const steps=`Right angle = 90 ‚Üí ${a}x ${b>=0?'+':''}${b} = 90 ‚Üí x=${sol}`;
      function diagram(){
        drawBase();
        const Bx=250,By=200; const Ax=400,Ay=200; const Cx=250,Cy=50;
        svg.appendChild(line(Bx,By,Ax,Ay)); svg.appendChild(line(Bx,By,Cx,Cy));
        svg.appendChild(circle(Bx,By,4));
        svg.appendChild(textEl(Ax,Ay+20,'A'));
        svg.appendChild(textEl(Bx-15,By+15,'B'));
        svg.appendChild(textEl(Cx-15,Cy,'C'));
      }
      return {prompt:promptText, steps, x:sol, diagram}
    }

    function nextProblem(){
      current=genRightAngle();
      prompt.innerHTML=current.prompt;
      current.diagram();
      stepsBox.hidden=true; feedback.textContent=''; ansInput.value='';
    }

    function checkAnswer(){
      const raw=ansInput.value.trim(); if(!raw) return;
      const val=evalFraction(raw);
      if(val===null){feedback.textContent='Enter a valid number.';return;}
      if(Math.abs(val-current.x)<1e-9){
        score+=100; streak++; scoreEl.textContent=score; streakEl.textContent=streak;
        feedback.textContent='‚úÖ Correct!'; stepsBox.hidden=false; stepsBox.innerHTML=current.steps;
        setTimeout(nextProblem,1200);
      } else {streak=0; streakEl.textContent=streak; feedback.textContent='‚ùå Try again';}
    }

    function evalFraction(str){
      if(/^[-+]?\\d+(?:\\.\\d+)?$/.test(str)) return Number(str);
      const m=str.match(/([-+]?\\d+(?:\\.\\d+)?)\\s*\\/\\s*([-+]?\\d+(?:\\.\\d+)?)/);
      if(m){const n=Number(m[1]); const d=Number(m[2]); if(d!==0) return n/d;}
      return null;
    }

    function startGame(){
      score=0;streak=0;time=180; // longer timer (3 minutes)
      scoreEl.textContent=0;streakEl.textContent=0;timeEl.textContent=time;
      running=true;nextProblem();
      clearInterval(timer);
      timer=setInterval(()=>{time--; timeEl.textContent=time; if(time<=0){clearInterval(timer); running=false; prompt.textContent='‚è∞ Time up!';}},1000)
    }

    checkBtn.addEventListener('click',checkAnswer);
    startBtn.addEventListener('click',startGame);

    // === Generate fun star background ===
    const stars=document.getElementById('stars');
    for(let i=0;i<80;i++){
      const s=document.createElement('div');
      s.className='star';
      s.style.left=Math.random()*100+'%';
      s.style.top=Math.random()*100+'%';
      s.style.animationDuration=(2+Math.random()*3)+'s';
      stars.appendChild(s);
    }
  </script>
</body>
</html>
